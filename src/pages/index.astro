---
import Base from "../layouts/Base.astro";
import { getSupabaseServerClient } from "../lib/supabase/server";

const supabase = getSupabaseServerClient(Astro);
const {
  data: { user },
} = await supabase.auth.getUser();
---
<Base title="Microblog - Welcome">
  <section class="grid gap-4 md:grid-cols-[2fr_1fr]">
    <div class="card p-5">
      <h1 class="mb-2 text-xl font-bold">What is Microblog?</h1>
      <p class="text-muted">Microblog is a simple place to share short updates with friends, family, and coworkers.</p>
      <p class="mt-2 text-muted">Post quick thoughts, follow people you like, and see what is happening right now.</p>
      <a class="mt-4 inline-block rounded border border-accent-dark bg-accent px-4 py-2 font-bold text-white" href="/signup">Get Started - Join!</a>
    </div>

    <aside class="card p-4">
      {user ? (
        <>
          <strong>Signed in</strong>
          <p class="mt-2 text-xs text-muted">You are already signed in.</p>
          <a class="mt-3 inline-block rounded border border-border bg-[#e5eef5] px-4 py-2 text-sm font-bold" href="/home">Go to timeline</a>
        </>
      ) : (
        <>
          <strong>Sign in</strong>
          <form method="post" action="/api/auth/login" class="mt-2" novalidate>
            <label class="block text-xs text-muted" for="email">Email</label>
            <input class="mt-1 w-full rounded border border-border p-2 text-sm" id="email" name="email" type="email" placeholder="you@example.com" required />
            <label class="mt-2 block text-xs text-muted" for="password">Password</label>
            <input class="mt-1 w-full rounded border border-border p-2 text-sm" id="password" name="password" type="password" placeholder="******" required />
            <button class="btn mt-3" type="submit">Sign in</button>
          </form>
          <p class="mt-3 text-xs text-muted">New here? <a href="/signup" class="text-link">Create an account</a></p>
        </>
      )}
    </aside>
  </section>

  <section class="card mt-5 p-4">
    <strong>Why people use Microblog</strong>
    <p class="mt-2 text-sm text-muted">Fast updates - Simple profiles - Public or private posts - Clean timeline</p>
  </section>
</Base>
